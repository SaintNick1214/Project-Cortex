[pytest]
minversion = 8.0
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts = 
    -ra
    -q
    --strict-markers
    -n 4
asyncio_mode = auto
; Per-test timeout (20 minutes = 1200 seconds)
; Prevents individual tests from hanging indefinitely and consuming GH Actions minutes.
; Uses pytest-timeout plugin. Tests exceeding this limit will be terminated and marked as failed.
timeout = 1200
; IMPORTANT: Must use 'thread' method when using pytest-xdist (-n option).
; The default 'signal' method doesn't work in worker subprocesses.
timeout_method = thread
; Parallel execution with pytest-xdist:
;   -n 4: Use 4 workers (optimal for GH Actions which has 4 CPUs on public repos)
;   -n auto: Use all CPU cores (better for local development with many cores)
;   -n 0: Serial execution (for debugging)
; 
; Coverage with parallel (uses .coveragerc for proper parallel config):
;   pytest --cov=cortex --cov-report=term-missing tests/
;
; The .coveragerc file configures:
;   - parallel=true: Each worker writes to a unique .coverage.xxx file
;   - pytest-cov automatically combines coverage data after tests complete
;   - branch=true: Track branch coverage for accurate metrics
filterwarnings =
    ignore::DeprecationWarning:neo4j.*
    ignore::pytest.PytestCollectionWarning

markers =
    asyncio: mark test as async
    integration: mark test as integration test
    graph: mark test as requiring graph database
    slow: mark test as slow running

