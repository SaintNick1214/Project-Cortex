---
id: memory-space-operations
title: Memory Space Operations API
sidebar_position: 3
description: Complete API reference for cortex.memorySpaces.* namespace - managing memory spaces, participants, and access control.
---

# Memory Space Operations API

<Callout type="info">
**Last Updated**: 2026-01-08
</Callout>

This document covers the `cortex.memorySpaces.*` namespace for managing memory spaces, participants, and access control.

## Overview

**Memory spaces** are the fundamental isolation boundary in Cortex. The `cortex.memorySpaces.*` API provides explicit management and registration capabilities beyond the implicit creation that happens automatically when you first use a memorySpaceId.

**When to use this API:**

- Production deployments (explicit registration)
- Analytics and observability needs
- Hive Mode with participant tracking
- Memory space lifecycle management
- Access control and permissions
- Multi-tenant SaaS (automatic `tenantId` isolation via AuthContext)

**When you don't need it:**

- Quick prototypes (use implicit creation)
- Simple single-agent apps
- When you just want memory to "just work"

---

## Table of Contents

- [register()](#register) - Register a memory space with metadata
- [get()](#get) - Retrieve memory space details
- [list()](#list) - List all memory spaces with pagination
- [count()](#count) - Count memory spaces
- [search()](#search) - Search memory spaces by metadata
- [update()](#update) - Update memory space metadata
- [addParticipant()](#addparticipant) - Add a single participant
- [removeParticipant()](#removeparticipant) - Remove a single participant
- [updateParticipants()](#updateparticipants) - Add/remove multiple participants (Hive Mode)
- [findByParticipant()](#findbyparticipant) - Find spaces by participant
- [archive()](#archive) - Mark memory space as inactive
- [reactivate()](#reactivate) - Reactivate archived space
- [delete()](#delete) - Delete memory space and all data
- [getStats()](#getstats) - Get analytics for a memory space

---

## register()

Register a memory space with metadata and participant tracking.

### Signature

```typescript
cortex.memorySpaces.register(
  params: RegisterMemorySpaceParams,
  options?: { syncToGraph?: boolean }
): Promise<MemorySpace>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "Memory space ID (e.g., \"user-123-personal\")" },
    { name: "tenantId", type: "string", required: false, description: "Multi-tenancy isolation (auto-injected from AuthContext)" },
    { name: "name", type: "string", required: false, description: "Human-readable name" },
    { name: "type", type: "\"personal\" | \"team\" | \"project\" | \"custom\"", required: true, description: "Organization type" },
    { name: "participants", type: "Array<{ id: string; type: string }>", required: false, description: "For Hive Mode tracking - participant identifier and type (\"user\", \"agent\", \"tool\", etc.)" },
    { name: "metadata", type: "Record<string, unknown>", required: false, description: "Custom metadata" },
  ]}
/>

**Options:**

<APITable
  parameters={[
    { name: "syncToGraph", type: "boolean", required: false, default: "false", description: "Sync to graph database" },
  ]}
/>

### Returns

```typescript
interface MemorySpace {
  _id: string;
  memorySpaceId: string;
  name?: string;
  type: "personal" | "team" | "project" | "custom";
  tenantId?: string; // Auto-injected from AuthContext for multi-tenancy
  participants: Array<{
    id: string;
    type: string;
    joinedAt: number;
  }>;
  metadata: Record<string, unknown>;
  status: "active" | "archived";
  createdAt: number;
  updatedAt: number;
}
```

### Examples

<Tabs>
<TabItem value="personal" label="Personal AI Memory">

```typescript
// Register user's personal memory space
await cortex.memorySpaces.register({
  memorySpaceId: "user-123-personal",
  name: "Alice's Personal AI Memory",
  type: "personal",
  participants: [
    { id: "cursor", type: "ai-tool" },
    { id: "claude", type: "ai-tool" },
    { id: "notion-ai", type: "ai-tool" },
  ],
  metadata: {
    owner: "user-123",
    environment: "production",
  },
});
```

</TabItem>
<TabItem value="team" label="Team Workspace">

```typescript
// Register team workspace
await cortex.memorySpaces.register({
  memorySpaceId: "team-engineering-workspace",
  name: "Engineering Team Workspace",
  type: "team",
  participants: [
    { id: "code-review-bot", type: "agent" },
    { id: "deployment-bot", type: "agent" },
    { id: "ticket-bot", type: "agent" },
  ],
  metadata: {
    team: "engineering",
    project: "apollo",
  },
});
```

</TabItem>
<TabItem value="graph-sync" label="With Graph Sync">

```typescript
// Register and sync to graph database
await cortex.memorySpaces.register(
  {
    memorySpaceId: "finance-agent-space",
    name: "Finance Agent Memory",
    type: "custom",
    participants: [{ id: "finance-agent", type: "agent" }],
  },
  { syncToGraph: true },
);
```

</TabItem>
</Tabs>

### Error Handling

```typescript
try {
  await cortex.memorySpaces.register({
    memorySpaceId: "space-123",
    type: "personal",
  });
} catch (error) {
  if (error.code === "MEMORYSPACE_ALREADY_EXISTS") {
    console.log("Space already registered");
    // Use update() instead
  }
}
```

---

## get()

Retrieve memory space details and metadata.

### Signature

```typescript
cortex.memorySpaces.get(memorySpaceId: string): Promise<MemorySpace | null>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "The memory space ID to retrieve" },
  ]}
/>

### Examples

<Tabs>
<TabItem value="basic" label="Basic Get">

```typescript
const space = await cortex.memorySpaces.get("user-123-personal");

if (space) {
  console.log(space.name); // "Alice's Personal AI Memory"
  console.log(space.participants); // [{ id: 'cursor', type: 'ai-tool', joinedAt: 1234567890 }, ...]
  console.log(space.type); // 'personal'
}
```

</TabItem>
<TabItem value="exists" label="Check if Exists">

```typescript
const space = await cortex.memorySpaces.get("unknown-space");

if (space === null) {
  console.log("Memory space does not exist");
  // Create it
  await cortex.memorySpaces.register({
    memorySpaceId: "unknown-space",
    type: "personal",
  });
}
```

</TabItem>
</Tabs>

---

## list()

List memory spaces with filtering, pagination, and sorting.

### Signature

```typescript
cortex.memorySpaces.list(filters?: ListMemorySpacesFilter): Promise<ListMemorySpacesResult>
```

### Parameters

<APITable
  parameters={[
    { name: "type", type: "\"personal\" | \"team\" | \"project\" | \"custom\"", required: false, description: "Filter by memory space type" },
    { name: "status", type: "\"active\" | \"archived\"", required: false, description: "Filter by status" },
    { name: "tenantId", type: "string", required: false, description: "Multi-tenancy filter (auto-injected from AuthContext)" },
    { name: "participant", type: "string", required: false, description: "Filter by participant ID" },
    { name: "limit", type: "number", required: false, default: "100", description: "Maximum number of results" },
    { name: "offset", type: "number", required: false, default: "0", description: "Pagination offset" },
    { name: "sortBy", type: "\"createdAt\" | \"updatedAt\" | \"name\"", required: false, description: "Sort field" },
    { name: "sortOrder", type: "\"asc\" | \"desc\"", required: false, default: "\"desc\"", description: "Sort direction" },
  ]}
/>

### Returns

```typescript
interface ListMemorySpacesResult {
  spaces: MemorySpace[];
  total: number;
  hasMore: boolean;
  offset: number;
}
```

### Examples

<Tabs>
<TabItem value="all" label="List All">

```typescript
const result = await cortex.memorySpaces.list();

console.log(`Found ${result.total} memory spaces`);
result.spaces.forEach((space) => {
  console.log(`${space.name} (${space.type})`);
});
```

</TabItem>
<TabItem value="filter" label="Filter by Type">

```typescript
// Get all personal spaces
const personal = await cortex.memorySpaces.list({
  type: "personal",
  status: "active",
});

// Get all team workspaces
const teams = await cortex.memorySpaces.list({
  type: "team",
});
```

</TabItem>
<TabItem value="participant" label="Filter by Participant">

```typescript
// Find all spaces where Cursor participates
const cursorSpaces = await cortex.memorySpaces.list({
  participant: "cursor",
});

console.log(`Cursor operates in ${cursorSpaces.total} memory spaces`);
```

</TabItem>
<TabItem value="pagination" label="Pagination">

```typescript
// Get first 20
const page1 = await cortex.memorySpaces.list({ limit: 20, offset: 0 });

// Get next 20
if (page1.hasMore) {
  const page2 = await cortex.memorySpaces.list({ limit: 20, offset: 20 });
}
```

</TabItem>
<TabItem value="sorting" label="Sorting">

```typescript
// Sort by name ascending
const sorted = await cortex.memorySpaces.list({
  sortBy: "name",
  sortOrder: "asc",
});

// Most recently updated first
const recent = await cortex.memorySpaces.list({
  sortBy: "updatedAt",
  sortOrder: "desc",
});
```

</TabItem>
</Tabs>

---

## count()

Count memory spaces matching filter criteria.

### Signature

```typescript
cortex.memorySpaces.count(filter?: {
  type?: "personal" | "team" | "project" | "custom";
  status?: "active" | "archived";
}): Promise<number>
```

### Parameters

<APITable
  parameters={[
    { name: "type", type: "\"personal\" | \"team\" | \"project\" | \"custom\"", required: false, description: "Filter by memory space type" },
    { name: "status", type: "\"active\" | \"archived\"", required: false, description: "Filter by status" },
  ]}
/>

### Examples

```typescript
// Count all spaces
const total = await cortex.memorySpaces.count();

// Count active personal spaces
const activePersonal = await cortex.memorySpaces.count({
  type: "personal",
  status: "active",
});

console.log(`${activePersonal} active personal spaces out of ${total} total`);
```

---

## search()

Search memory spaces by name or metadata.

### Signature

```typescript
cortex.memorySpaces.search(query: string, options?: SearchOptions): Promise<MemorySpace[]>
```

### Parameters

<APITable
  parameters={[
    { name: "query", type: "string", required: true, description: "Search query string" },
    { name: "type", type: "\"personal\" | \"team\" | \"project\" | \"custom\"", required: false, description: "Filter by memory space type" },
    { name: "status", type: "\"active\" | \"archived\"", required: false, description: "Filter by status" },
    { name: "limit", type: "number", required: false, description: "Maximum number of results" },
  ]}
/>

### Examples

<Tabs>
<TabItem value="name" label="Search by Name">

```typescript
const results = await cortex.memorySpaces.search("engineering");

// Returns spaces with "engineering" in name or metadata
// [
//   { memorySpaceId: 'team-engineering-workspace', name: 'Engineering Team', ... },
//   { memorySpaceId: 'project-engineering-docs', name: 'Engineering Docs Project', ... }
// ]
```

</TabItem>
<TabItem value="filters" label="Search with Filters">

```typescript
const results = await cortex.memorySpaces.search("alice", {
  type: "personal",
  status: "active",
  limit: 5,
});
```

</TabItem>
</Tabs>

---

## update()

Update memory space metadata (not participants - use updateParticipants()).

### Signature

```typescript
cortex.memorySpaces.update(
  memorySpaceId: string,
  updates: MemorySpaceUpdates,
  options?: { syncToGraph?: boolean }
): Promise<MemorySpace>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "The memory space ID to update" },
    { name: "name", type: "string", required: false, description: "New human-readable name" },
    { name: "metadata", type: "Record<string, unknown>", required: false, description: "Metadata to merge with existing" },
    { name: "status", type: "\"active\" | \"archived\"", required: false, description: "New status" },
  ]}
/>

**Options:**

<APITable
  parameters={[
    { name: "syncToGraph", type: "boolean", required: false, default: "false", description: "Sync changes to graph database" },
  ]}
/>

### Examples

<Tabs>
<TabItem value="name" label="Update Name">

```typescript
await cortex.memorySpaces.update("user-123-personal", {
  name: "Alice's Updated Personal Space",
});
```

</TabItem>
<TabItem value="metadata" label="Update Metadata">

```typescript
await cortex.memorySpaces.update("team-engineering-workspace", {
  metadata: {
    lastReview: Date.now(),
    status: "active-development",
  },
});
```

</TabItem>
<TabItem value="graph" label="With Graph Sync">

```typescript
await cortex.memorySpaces.update(
  "team-engineering-workspace",
  { name: "Updated Team Space" },
  { syncToGraph: true },
);
```

</TabItem>
</Tabs>

---

## addParticipant()

Add a single participant to a memory space.

### Signature

```typescript
cortex.memorySpaces.addParticipant(
  memorySpaceId: string,
  participant: { id: string; type: string; joinedAt: number }
): Promise<MemorySpace>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "The memory space ID" },
    { name: "participant.id", type: "string", required: true, description: "Participant identifier" },
    { name: "participant.type", type: "string", required: true, description: "Participant type (\"user\", \"agent\", \"tool\", etc.)" },
    { name: "participant.joinedAt", type: "number", required: true, description: "Timestamp when participant joined" },
  ]}
/>

### Examples

```typescript
// User installs new AI tool
await cortex.memorySpaces.addParticipant("user-123-personal", {
  id: "github-copilot",
  type: "ai-tool",
  joinedAt: Date.now(),
});
```

---

## removeParticipant()

Remove a single participant from a memory space.

### Signature

```typescript
cortex.memorySpaces.removeParticipant(
  memorySpaceId: string,
  participantId: string
): Promise<MemorySpace>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "The memory space ID" },
    { name: "participantId", type: "string", required: true, description: "ID of the participant to remove" },
  ]}
/>

### Examples

```typescript
// User uninstalls tool
await cortex.memorySpaces.removeParticipant("user-123-personal", "old-tool");

// Note: Participant's existing memories remain (audit trail)
// But space no longer lists it as active participant
```

<Callout type="info">

Removing a participant does not delete their existing memories. The memories remain for audit trail purposes, but the space no longer lists them as an active participant.

</Callout>

---

## updateParticipants()

Add or remove multiple participants from a memory space (Hive Mode).

### Signature

```typescript
cortex.memorySpaces.updateParticipants(
  memorySpaceId: string,
  updates: ParticipantUpdates
): Promise<MemorySpace>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "The memory space ID" },
    { name: "add", type: "Array<{ id: string; type: string; joinedAt: number }>", required: false, description: "Participants to add" },
    { name: "remove", type: "string[]", required: false, description: "Participant IDs to remove" },
  ]}
/>

### Examples

<Tabs>
<TabItem value="add" label="Add Participants">

```typescript
// User installs new AI tools
await cortex.memorySpaces.updateParticipants("user-123-personal", {
  add: [
    { id: "github-copilot", type: "ai-tool", joinedAt: Date.now() },
    { id: "windsurf", type: "ai-tool", joinedAt: Date.now() },
  ],
});
```

</TabItem>
<TabItem value="remove" label="Remove Participants">

```typescript
// User uninstalls tools
await cortex.memorySpaces.updateParticipants("user-123-personal", {
  remove: ["old-tool-1", "old-tool-2"],
});
```

</TabItem>
<TabItem value="replace" label="Replace Participants">

```typescript
// Set exact participant list
await cortex.memorySpaces.updateParticipants("team-workspace", {
  remove: ["bot-1", "bot-2"], // Remove old
  add: [
    { id: "bot-3", type: "agent", joinedAt: Date.now() },
    { id: "bot-4", type: "agent", joinedAt: Date.now() },
  ],
});
```

</TabItem>
</Tabs>

---

## findByParticipant()

Find all memory spaces where a participant is active.

### Signature

```typescript
cortex.memorySpaces.findByParticipant(participantId: string): Promise<MemorySpace[]>
```

### Parameters

<APITable
  parameters={[
    { name: "participantId", type: "string", required: true, description: "The participant ID to search for" },
  ]}
/>

### Examples

```typescript
// Find all spaces where a specific user participates
const userSpaces = await cortex.memorySpaces.findByParticipant("user-123");

console.log(`User is active in ${userSpaces.length} memory spaces`);
userSpaces.forEach((space) => {
  console.log(`- ${space.name} (${space.type})`);
});
```

---

## archive()

Mark memory space as archived (inactive). Data is preserved but space is hidden from default lists.

### Signature

```typescript
cortex.memorySpaces.archive(memorySpaceId: string, options?: ArchiveOptions): Promise<MemorySpace>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "The memory space ID to archive" },
    { name: "reason", type: "string", required: false, description: "Why the space is being archived" },
    { name: "metadata", type: "Record<string, unknown>", required: false, description: "Additional archive metadata" },
  ]}
/>

### Examples

<Tabs>
<TabItem value="project" label="Archive Project">

```typescript
// Project complete, archive its memory space
await cortex.memorySpaces.archive("project-apollo", {
  reason: "Project completed successfully",
  metadata: {
    archivedBy: "admin-456",
    completedAt: Date.now(),
  },
});

// Space still exists, data intact, but marked inactive
const space = await cortex.memorySpaces.get("project-apollo");
console.log(space.status); // 'archived'
```

</TabItem>
<TabItem value="inactive" label="Archive Inactive User">

```typescript
// User hasn't logged in for 90 days
await cortex.memorySpaces.archive(`user-${userId}-personal`, {
  reason: "User inactive for 90 days",
  metadata: {
    lastSeen: user.lastSeen,
  },
});
```

</TabItem>
</Tabs>

---

## reactivate()

Reactivate an archived memory space.

### Signature

```typescript
cortex.memorySpaces.reactivate(memorySpaceId: string): Promise<MemorySpace>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "The archived memory space ID to reactivate" },
  ]}
/>

### Examples

```typescript
// User returns, reactivate their space
await cortex.memorySpaces.reactivate(`user-${userId}-personal`);

const space = await cortex.memorySpaces.get(`user-${userId}-personal`);
console.log(space.status); // 'active'
```

---

## delete()

<Callout type="danger">

**DESTRUCTIVE:** This operation permanently deletes the memory space and ALL associated data. This cannot be undone.

</Callout>

### Signature

```typescript
cortex.memorySpaces.delete(
  memorySpaceId: string,
  options: DeleteMemorySpaceOptions
): Promise<DeleteMemorySpaceResult>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "The memory space ID to delete" },
    { name: "cascade", type: "boolean", required: true, description: "Must be true to proceed with deletion" },
    { name: "reason", type: "string", required: true, description: "Why deleting (for audit trail)" },
    { name: "confirmId", type: "string", required: false, description: "Safety check - must match memorySpaceId" },
    { name: "syncToGraph", type: "boolean", required: false, description: "Also delete from graph database" },
  ]}
/>

### Returns

```typescript
interface DeleteMemorySpaceResult {
  memorySpaceId: string;
  deleted: true;
  cascade: {
    conversationsDeleted: number; // Layer 1a
    memoriesDeleted: number; // Layer 2
    factsDeleted: number; // Layer 3
    totalBytes: number; // Storage freed
  };
  reason: string;
  deletedAt: number;
}
```

### Examples

<Tabs>
<TabItem value="gdpr" label="GDPR Deletion">

```typescript
// User requests data deletion
const result = await cortex.memorySpaces.delete("user-123-personal", {
  cascade: true,
  reason: "GDPR deletion request from user-123",
  confirmId: "user-123-personal", // Safety check
});

console.log(`Deleted ${result.cascade.memoriesDeleted} memories`);
console.log(`Deleted ${result.cascade.conversationsDeleted} conversations`);
console.log(`Deleted ${result.cascade.factsDeleted} facts`);
```

</TabItem>
<TabItem value="cleanup" label="Project Cleanup">

```typescript
// Project archived, delete after retention period
await cortex.memorySpaces.delete("project-old-2023", {
  cascade: true,
  reason: "Data retention policy: 2 years expired",
});
```

</TabItem>
<TabItem value="safety" label="Safety Checks">

```typescript
// Without cascade - ERROR
try {
  await cortex.memorySpaces.delete("user-123-personal", {
    cascade: false, // Must be true
    reason: "Test",
  });
} catch (error) {
  console.error("Must set cascade: true to delete");
}

// With confirmId (extra safety)
await cortex.memorySpaces.delete("production-space", {
  cascade: true,
  reason: "Migration to new architecture",
  confirmId: "production-space", // Must match memorySpaceId
});
```

</TabItem>
</Tabs>

---

## getStats()

Get analytics and usage statistics for a memory space.

### Signature

```typescript
cortex.memorySpaces.getStats(
  memorySpaceId: string,
  options?: GetMemorySpaceStatsOptions
): Promise<MemorySpaceStats>
```

### Parameters

<APITable
  parameters={[
    { name: "memorySpaceId", type: "string", required: true, description: "The memory space ID" },
    { name: "timeWindow", type: "\"24h\" | \"7d\" | \"30d\" | \"90d\" | \"all\"", required: false, default: "\"all\"", description: "Time window for activity metrics" },
    { name: "includeParticipants", type: "boolean", required: false, default: "false", description: "Include participant activity breakdown (Hive Mode)" },
  ]}
/>

### Returns

```typescript
interface MemorySpaceStats {
  memorySpaceId: string;

  // Counts
  totalMemories: number;
  totalConversations: number;
  totalFacts: number;
  totalMessages: number;

  // Activity (based on timeWindow)
  memoriesThisWindow?: number;
  conversationsThisWindow?: number;

  // Storage
  storage: {
    conversationsBytes: number;
    memoriesBytes: number;
    factsBytes: number;
    totalBytes: number;
  };

  // Performance
  avgSearchTime?: string; // Average search latency (e.g., "12ms")

  // Content Analysis
  topTags: string[];
  importanceBreakdown: {
    critical: number; // 90-100
    high: number; // 70-89
    medium: number; // 40-69
    low: number; // 10-39
    trivial: number; // 0-9
  };

  // Participant Activity (if includeParticipants: true)
  participants?: Array<{
    participantId: string;
    memoriesStored: number;
    conversationsStored: number;
    factsExtracted: number;
    firstActive: number;
    lastActive: number;
    avgImportance: number;
    topTags: string[];
  }>;
}
```

### Examples

<Tabs>
<TabItem value="basic" label="Basic Stats">

```typescript
const stats = await cortex.memorySpaces.getStats("user-123-personal");

console.log(`Total memories: ${stats.totalMemories}`);
console.log(
  `Storage used: ${(stats.storage.totalBytes / 1024 / 1024).toFixed(2)} MB`,
);
console.log(`Top tags: ${stats.topTags.join(", ")}`);
```

</TabItem>
<TabItem value="window" label="With Time Window">

```typescript
// Last 7 days
const weekStats = await cortex.memorySpaces.getStats("user-123-personal", {
  timeWindow: "7d",
});

console.log(`Activity this week: ${weekStats.memoriesThisWindow} memories`);
console.log(`Conversations this week: ${weekStats.conversationsThisWindow}`);
```

</TabItem>
<TabItem value="participants" label="With Participant Breakdown">

```typescript
const stats = await cortex.memorySpaces.getStats("team-engineering-workspace", {
  timeWindow: "7d",
  includeParticipants: true,
});

console.log(`Activity this week: ${stats.memoriesThisWindow} memories`);

// Participant breakdown
stats.participants?.forEach((p) => {
  console.log(`${p.participantId}:`);
  console.log(`  - Stored: ${p.memoriesStored} memories`);
  console.log(`  - Last active: ${new Date(p.lastActive).toISOString()}`);
  console.log(`  - Avg importance: ${p.avgImportance}`);
});
```

</TabItem>
</Tabs>

---

## Common Patterns

### Pattern 1: Dynamic Space Creation (SaaS)

```typescript
// Create memory space per customer on signup
async function onUserSignup(userId: string) {
  const memorySpaceId = `customer-${userId}-space`;

  await cortex.memorySpaces.register({
    memorySpaceId,
    name: `Customer ${userId} Memory`,
    type: "personal",
    metadata: {
      customerId: userId,
      tier: "free",
      signupDate: Date.now(),
    },
  });

  return memorySpaceId;
}
```

### Pattern 2: Team Workspace Management

```typescript
// Admin creates team workspace
async function createTeamWorkspace(
  teamId: string,
  teamName: string,
  members: string[],
) {
  const memorySpaceId = `team-${teamId}-workspace`;

  await cortex.memorySpaces.register({
    memorySpaceId,
    name: `${teamName} Workspace`,
    type: "team",
    participants: members.map((m) => ({
      id: `bot-${m}`,
      type: "agent",
    })),
    metadata: {
      teamId,
      createdBy: "admin",
      members,
    },
  });

  return memorySpaceId;
}

// Add new member
async function addTeamMember(teamId: string, memberId: string) {
  await cortex.memorySpaces.addParticipant(`team-${teamId}-workspace`, {
    id: `bot-${memberId}`,
    type: "agent",
    joinedAt: Date.now(),
  });
}
```

### Pattern 3: Lifecycle Management

```typescript
// Complete lifecycle
async function memorySpaceLifecycle(projectId: string) {
  const memorySpaceId = `project-${projectId}`;

  // 1. Create
  await cortex.memorySpaces.register({
    memorySpaceId,
    type: "project",
    metadata: { status: "active" },
  });

  // 2. Use (implicit in app)
  // await cortex.memory.remember({ memorySpaceId, ... });

  // 3. Complete project - archive
  await cortex.memorySpaces.archive(memorySpaceId, {
    reason: "Project completed",
  });

  // 4. After retention period - delete
  await cortex.memorySpaces.delete(memorySpaceId, {
    cascade: true,
    reason: "Retention period (2 years) expired",
  });
}
```

### Pattern 4: Analytics Dashboard

```typescript
// Build memory space analytics dashboard
async function getMemorySpaceDashboard() {
  const result = await cortex.memorySpaces.list({ status: "active" });

  const dashboard = await Promise.all(
    result.spaces.map(async (space) => {
      const stats = await cortex.memorySpaces.getStats(space.memorySpaceId, {
        timeWindow: "7d",
        includeParticipants: true,
      });

      return {
        name: space.name,
        type: space.type,
        participants: space.participants.length,
        memoriesThisWeek: stats.memoriesThisWindow,
        storage: stats.storage.totalBytes,
        topParticipant: stats.participants?.[0]?.participantId,
      };
    }),
  );

  return dashboard;
}

// Usage
const dashboard = await getMemorySpaceDashboard();
console.table(dashboard);
```

---

## Best Practices

### 1. Use Structured IDs

```typescript
// Good: Structured, searchable
"user-{userId}-personal";
"team-{teamId}-workspace";
"project-{projectId}-memory";

// Avoid: Random, opaque
"abc123";
"temp";
"space1";
```

### 2. Always Register in Production

```typescript
// Development: Implicit is fine
await cortex.memory.remember({ memorySpaceId: "test-space", ... });

// Production: Explicit registration
await cortex.memorySpaces.register({
  memorySpaceId: "user-123-personal",
  name: "Alice's Personal Space",
  type: "personal",
  metadata: { environment: "production" },
});
```

### 3. Track Participants in Hive Mode

```typescript
// Good: Clear participant list with types
await cortex.memorySpaces.register({
  memorySpaceId: "user-123-personal",
  participants: [
    { id: "cursor", type: "ai-tool" },
    { id: "claude", type: "ai-tool" },
    { id: "notion-ai", type: "ai-tool" },
  ],
});
```

### 4. Use Metadata for Organization

```typescript
// Rich metadata for filtering and search
await cortex.memorySpaces.register({
  memorySpaceId: "user-123-personal",
  metadata: {
    owner: "user-123",
    environment: "production",
    tier: "pro",
    region: "us-west-2",
    created: Date.now(),
    tags: ["active", "premium"],
  },
});
```

### 5. Archive Before Delete

<Callout type="tip">

Always archive a memory space before deleting it. This provides a grace period for recovery and maintains data integrity during the retention period.

</Callout>

```typescript
// Recommended: Archive first, delete later
await cortex.memorySpaces.archive(memorySpaceId, { reason: "Inactive" });

// Wait for retention period...

// Then delete
await cortex.memorySpaces.delete(memorySpaceId, {
  cascade: true,
  reason: "Retention period expired",
});

// Avoid: Direct deletion without archival period
```

---

## Error Handling

### Common Errors

**MEMORYSPACE_ALREADY_EXISTS:**

```typescript
try {
  await cortex.memorySpaces.register({ memorySpaceId: "user-123-personal", type: "personal" });
} catch (error) {
  if (error.message?.includes("MEMORYSPACE_ALREADY_EXISTS")) {
    // Use update() instead
    await cortex.memorySpaces.update("user-123-personal", { ... });
  }
}
```

**MEMORYSPACE_NOT_FOUND:**

```typescript
const space = await cortex.memorySpaces.get("nonexistent-space");

if (space === null) {
  // Create it
  await cortex.memorySpaces.register({
    memorySpaceId: "nonexistent-space",
    type: "personal",
  });
}
```

**CASCADE_REQUIRED (Delete Prevention):**

```typescript
try {
  await cortex.memorySpaces.delete("active-space", {
    cascade: false,
    reason: "Test",
  });
} catch (error) {
  if (error.message?.includes("CASCADE_REQUIRED")) {
    console.error("Must set cascade: true to delete space with data");
  }
}
```

**CONFIRM_ID_MISMATCH:**

```typescript
try {
  await cortex.memorySpaces.delete("space-123", {
    cascade: true,
    reason: "Test",
    confirmId: "wrong-id", // Doesn't match
  });
} catch (error) {
  if (error.message?.includes("CONFIRM_ID_MISMATCH")) {
    console.error("confirmId must match memorySpaceId");
  }
}
```

---

## Conclusion

The Memory Space Operations API provides explicit control over memory space lifecycle, participant management, and analytics.

**Key Takeaways:**

- Registration is optional (implicit creation works)
- Register in production for analytics and tracking
- Use participants for Hive Mode tracking
- Archive before delete (safer)
- Monitor with getStats() for observability

<Callout type="info">

**Most important:** memorySpaceId is the fundamental isolation boundary. Everything else builds on this.

</Callout>

---

<QuickNav>

<QuickNavItem
  title="Memory Operations API"
  description="Using memory spaces"
  href="/api-reference/memory-operations"
/>

<QuickNavItem
  title="Hive Mode Guide"
  description="Multi-tool memory sharing"
  href="/core-features/hive-mode"
/>

<QuickNavItem
  title="Memory Spaces Guide"
  description="Core concepts"
  href="/core-features/memory-spaces"
/>

<QuickNavItem
  title="A2A Communication"
  description="Collaboration Mode"
  href="/api-reference/a2a-communication"
/>

</QuickNav>

**Questions?** Ask in [Discussions](https://github.com/SaintNick1214/Project-Cortex/discussions).
